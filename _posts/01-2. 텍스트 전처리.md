# ìì—°ì–´ ì „ì²˜ë¦¬


```python
import pandas as pd
import numpy as np
from tqdm import tqdm
tqdm.pandas()

import seaborn as sns
import matplotlib
import matplotlib.pyplot as plt
matplotlib.rcParams['font.family'] ='Malgun Gothic'
matplotlib.rcParams['axes.unicode_minus'] =False
```



    


# ê²°ì¸¡ê°’/ì¤‘ë³µê°’ ì œê±°


```python
import re

raw = df.shape[0]
print('- raw data: {:,}'.format(raw))


#ê²°ì¸¡ê°’ ì œê±°
print('- null data: {:,}'.format(df['contents'].isnull().sum()))
df = df.dropna() 
deleted_null = df.shape[0]



#ì¤‘ë³µ ì œê±°
df = df.drop_duplicates() 
deleted_dup = df.shape[0]
print('- duplicated data: {:,}'.format(deleted_null - deleted_dup))



#ë¬¸ì¥ ê¸¸ì´
df['contents_length'] = df['contents'].apply(lambda x : len(x))
```

    - raw data: 3,564,042
    - null data: 0
    - duplicated data: 0
    

# ì£¼ìš” ì´ëª¨ì§€ ë° íŠ¹ìˆ˜í‘œí˜„ í‘œì œí™”


```python
def emoji_lemmatization(sentence):
    heart_emoji = ['â™¡', 'â™¥', 'â¤', 'â¤ï¸', 'ğŸ§¡', 'ğŸ’›', 'ğŸ’š', 'ğŸ’™', 'ğŸ’œ', 'ğŸ’•'] #
    star_emoji = ['â˜†', 'â˜…', 'â­', 'ğŸŒŸ']
    kkk = ['ğ¨›', 'ğŒ…', 'â«¬', 'ãƒ²', 'åˆ', 'ã‰ª', 'ï½¦']
    Period = ['ã†', 'á†', 'ã†', 'â€¢', 'á†¢']
    quote = ['â€', 'â€˜', 'â€œ']
    ect = ['Â ', 'ã…¤']
    
    for i in range(len(sentence)):
        if sentence[i] in heart_emoji:
            sentence = sentence.replace(sentence[i], 'â™¥')
        elif sentence[i] in star_emoji:
            sentence = sentence.replace(sentence[i], 'â˜…')
        elif sentence[i] in kkk:
            sentence = sentence.replace(sentence[i], 'ã…‹')
        elif sentence[i] in Period:
            sentence = sentence.replace(sentence[i], '.')
        elif sentence[i] in quote:
            sentence = sentence.replace(sentence[i], '\'')
        elif sentence[i] in ect:
            sentence = sentence.replace(sentence[i], ' ')
        else:
            pass
    return(sentence)

def kkk_lemmatization(sentence):
    kkk2 =['ã…‹ê™¼Ìˆ', 'ã…‹Ì‘Ìˆ', 'ã…‹Ì†Ì', 'ã…‹ÌÌˆ', 'ã…‹ÌŠÌˆ', 'ã…‹Ì„Ìˆ', 'ã…‹Ì†Ìˆ', 'ã…‹ÌŠÌˆ', 'ã…‹ÌÌˆ', 'ã…‹Ì†Ì']
    
    for i in range(len(kkk2)):
        if kkk2[i] in sentence:
            sentence =  sentence.replace(kkk2[i], 'ã…‹')
        else:
            pass
    return(sentence)

text_sentence = 'â¤ğŸ§¡ğŸ’›í…ŒìŠ¤íŠ¸ğŸ’šğŸ’™ğŸ’œâ˜†ì…ë‹ˆë‹¤â˜…á†¢â­ ãƒ²ğ¨›ğŒ…â«¬ã…‹Ì„Ìˆã…‹ê™¼Ìˆã…‹Ì†Ìã…‹ÌÌˆã…‹ÌŠÌˆã…‹Ì„Ìˆã…‹ê™¼Ìˆã…‹Ì†Ìã…‹ÌÌˆã…‹ÌŠÌˆ'
text_sentence = emoji_lemmatization(text_sentence)
text_sentence = kkk_lemmatization(text_sentence)
text_sentence
```




    'â™¥â™¥â™¥í…ŒìŠ¤íŠ¸â™¥â™¥â™¥â˜…ì…ë‹ˆë‹¤â˜….â˜… ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹'




```python
df['contents'] = df['contents'].progress_apply(emoji_lemmatization)
df['contents'] = df['contents'].progress_apply(kkk_lemmatization)
```

    100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3564042/3564042 [05:13<00:00, 11354.18it/s]
    100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3564042/3564042 [00:10<00:00, 330031.43it/s]
    

# ë°˜ë³µë˜ëŠ” ë™ì¼ ìŒì ˆ í‘œì œí™” ì²˜ë¦¬


```python
def duplicated_spelling_reduction(sentence):
    reduced_spellings = []
    duplicated_num = 1
    for i in range(len(sentence)):
        spelling = sentence[i]
        try:
            previous_spelling = sentence[i-1]
            
        except:
            previous_spelling = 'first_spelling'
        
        if spelling == previous_spelling:
            duplicated_num += 1
        else:
            duplicated_num = 1
            pass
        
        if duplicated_num <= 5:
            reduced_spellings.append(spelling)
        else:
            pass      
        
    reduced_sentence = ''.join(reduced_spellings).replace('   ', ' ').replace('  ', ' ')
    return(reduced_sentence)

text_sentence = '    ì•ˆë…•ì•ˆë…• í—¤í—¤í—¤ ã…‹ã…‹ã…‹ã…‹ ã…ã…ã…ã…ã…ã…ã…ã… ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹'
duplicated_spelling_reduction(text_sentence)
```




    ' ì•ˆë…•ì•ˆë…• í—¤í—¤í—¤ ã…‹ã…‹ã…‹ã…‹ ã…ã…ã…ã…ã… ã…‹ã…‹ã…‹ã…‹ã…‹'




```python
df['contents'] = df['contents'].progress_apply(duplicated_spelling_reduction)
```

    100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3564042/3564042 [02:02<00:00, 29125.25it/s]
    

# ê³µë°±(ì¤‘ë³µ ë„ì–´ì“°ê¸°)/5ì–´ì ˆ ë¯¸ë§Œ ë¬¸ì¥ ì œê±°


```python
#ë„ì–´ì“°ê¸° ë¬¸ì¥ ì œê±°
df['contents'] = df['contents'].apply(lambda x : re.sub(r'\s', ' ', x))  #ë„ì–´ì“°ê¸° ì¤‘ë³µ ''ë¡œ ë³€ê²½
mask = df['contents'].isin([' '])
df = df[~mask].reset_index(drop = True) 
deleted_white = df.shape[0]
white = deleted_dup - deleted_white
print("- white space data: {:,}({}%)".format(white, round(white/deleted_dup*100, 2)))

#ì–´ì ˆ ì¹´ìš´íŒ…
df['word_bunch'] = df['contents'].apply(lambda x: len(x.split(' ')))


#5ì–´ì ˆ ë¯¸ë§Œ ë¬¸ì¥ ì œê±°
cutoff = df.loc[df['word_bunch'] < 5].shape[0] 
df = df.loc[df['word_bunch'] >= 5] 
deleted_cutoff = df.shape[0]
print("- cutoff data: {:,}({}%)".format(cutoff, round(cutoff/deleted_white*100, 2)))

print("- total processed data: {:,}".format(deleted_cutoff))
```

    - white space data: 0(0.0%)
    - cutoff data: 61,130(1.72%)
    - total processed data: 3,502,912
    


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>topic</th>
      <th>sex</th>
      <th>age</th>
      <th>resident</th>
      <th>contents</th>
      <th>length</th>
      <th>spell_num</th>
      <th>spell_mean</th>
      <th>spell_std</th>
      <th>spell_max</th>
      <th>spell_min</th>
      <th>symbol_num</th>
      <th>symbol_mean</th>
      <th>symbol_std</th>
      <th>symbol_max</th>
      <th>symbol_min</th>
      <th>contents_length</th>
      <th>word_bunch</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ê°œì¸ë°ê´€ê³„</td>
      <td>ì—¬ì„±</td>
      <td>20ëŒ€</td>
      <td>ê²½ê¸°ë„</td>
      <td>ë‚˜ì§€ê¸ˆë°¥ë¨¸ê±°2ì‹œê°„ê±¸ì–´ì„œ ë²ˆí™”ê°€ì°¾ì•˜ì–´..ã…œã…œ ì‰ã…œã…œ ã…ã…ã…ã…ì˜¤ì¢‹ê² ë„¤ ã…‹ã„±ã…‹ã„±ã„±ã„±ã„±ì•„ë‹ˆ...</td>
      <td>127</td>
      <td>6</td>
      <td>2.185021</td>
      <td>1.299761</td>
      <td>3.765840</td>
      <td>0.693147</td>
      <td>4</td>
      <td>0.173287</td>
      <td>0.300142</td>
      <td>0.693147</td>
      <td>0.000000</td>
      <td>127</td>
      <td>16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ê°œì¸ë°ê´€ê³„</td>
      <td>ë‚¨ì„±</td>
      <td>20ëŒ€</td>
      <td>ê²½ê¸°ë„</td>
      <td>í— ã… ã…  ì–¸ë„í˜¸í…”ë“¤ê°€ã… ã…  ì—„ì²­í”¼ê±´í• ì²¸ë° ë‚˜ëŠ”ì¸ë‚«ëŸ¬ìš” ë‚˜ ë‘ì‹œì¶œê·¼ì´ë‹¤ã…ã…ã…ã… í€µìœ¼ë¡œí•œ...</td>
      <td>130</td>
      <td>6</td>
      <td>0.961387</td>
      <td>0.555163</td>
      <td>1.609438</td>
      <td>0.000000</td>
      <td>6</td>
      <td>2.041180</td>
      <td>1.296771</td>
      <td>4.212128</td>
      <td>0.693147</td>
      <td>130</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ê°œì¸ë°ê´€ê³„</td>
      <td>ì—¬ì„±</td>
      <td>20ëŒ€</td>
      <td>ê²½ê¸°ë„</td>
      <td>í•™ìƒì´ë©´ì¢‹êµ¬! ì™œí˜¼ìë‹¤ë‹ˆëƒê³ ì˜¤..... ì™€ ë‚´ì¹œêµ°í•™êµë‚˜ê° ã…‹ã…‹ã…‹ã…‹ã…‹ ê·¸ë¥´ë„¤ ë§‰ì¡¸ì—…í•œ...</td>
      <td>56</td>
      <td>1</td>
      <td>2.197225</td>
      <td>0.000000</td>
      <td>2.197225</td>
      <td>2.197225</td>
      <td>3</td>
      <td>1.404043</td>
      <td>1.072424</td>
      <td>2.602690</td>
      <td>0.000000</td>
      <td>56</td>
      <td>7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ê°œì¸ë°ê´€ê³„</td>
      <td>ë‚¨ì„±</td>
      <td>20ëŒ€</td>
      <td>ê²½ê¸°ë„</td>
      <td>í›” í•™ìƒ ì—†ëŠ”ë°...ì£¼ë³€ì—... ì•„ë‹ˆ ë³µí•™í•˜ê³  í•™êµë¥¼ ëª»ê°€ëŠ”ë° ì–´ì¼€ ì¹œêµ¬ê°€ìˆëƒ.. ...</td>
      <td>74</td>
      <td>1</td>
      <td>2.079442</td>
      <td>0.000000</td>
      <td>2.079442</td>
      <td>2.079442</td>
      <td>4</td>
      <td>0.997246</td>
      <td>0.175572</td>
      <td>1.098612</td>
      <td>0.693147</td>
      <td>74</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ê°œì¸ë°ê´€ê³„</td>
      <td>ì—¬ì„±</td>
      <td>30ëŒ€</td>
      <td>ì¶©ì²­ë¶ë„</td>
      <td>ì°¸ë‚˜ ë‚´ê°€ë­ì–¼ë§ˆë‚˜ê·¸ë¬ë‹¤ê³  ì›ƒê¸°ëŠ”ì‚¬ëŒì´ì•¼ì§€ì§œ ë„ˆë¬´í™”ë‚œë‹¹.. ê·¼ë°ì˜¤ë¹ ëŠ”ë§ì„ë˜ ì˜í•´ì„œ ë‚´...</td>
      <td>146</td>
      <td>2</td>
      <td>0.693147</td>
      <td>0.000000</td>
      <td>0.693147</td>
      <td>0.693147</td>
      <td>1</td>
      <td>0.693147</td>
      <td>0.000000</td>
      <td>0.693147</td>
      <td>0.693147</td>
      <td>146</td>
      <td>19</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3564036</th>
      <td>í–‰ì‚¬</td>
      <td>ì—¬ì„±</td>
      <td>20ëŒ€</td>
      <td>ì„œìš¸íŠ¹ë³„ì‹œ</td>
      <td>User ì˜¤ë©´ í•  ê±° ë§ë‹¤ ìš°ì„  ì—½ë–¡ê³¼ ë…¸ë˜ë°©ì€ í™•ì •ì´ì•¼ ê·¸ë¦¬ê³  ì²­ë…„ë‹¤ë°© í•˜ë£¨ë¡œ ì•ˆ...</td>
      <td>56</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>56</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3564038</th>
      <td>í–‰ì‚¬</td>
      <td>ì—¬ì„±</td>
      <td>30ëŒ€</td>
      <td>ê²½ê¸°ë„</td>
      <td>ë‹¤ìŒë‚ ì€ ì¼ì–´ë‚˜ì„œ ê·¼ì²˜ ë˜ ìœ ëª…ë¹µì§‘ ê°€ì„œ ì ì‹¬ì„ ë¨¹ê³  ì§‘ìœ¼ë¡œ ë³µê·€! ì–´ì œ ì ì‹¬ë¨¹ì„ê³³...</td>
      <td>61</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>61</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3564039</th>
      <td>í–‰ì‚¬</td>
      <td>ë‚¨ì„±</td>
      <td>20ëŒ€</td>
      <td>ì¸ì²œê´‘ì—­ì‹œ</td>
      <td>ì§‘ì„ ê°€ëŠ”êµ°ì—¬! ì•„ì£¼ìš°!!!!! ì¢‹ìŠµë„¤ë‹¤ User!!!! ì•„ì£¼ì¢‹ì•„ìš”! ë‹¤ìŒì£¼ì•¼ ì–´ì°¨í”¼!</td>
      <td>48</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5</td>
      <td>0.599146</td>
      <td>0.737187</td>
      <td>1.609438</td>
      <td>0.000000</td>
      <td>48</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3564040</th>
      <td>í–‰ì‚¬</td>
      <td>ì—¬ì„±</td>
      <td>20ëŒ€</td>
      <td>ì„œìš¸íŠ¹ë³„ì‹œ</td>
      <td>ê·¼ë° ë™ì°½íšŒ ì¸ë¬¸ê³„ê¹Œì§€ ì‹¹ ë‹¤ í•˜ë ¤ë©´ ì ˆëŒ€ ëª»í•´.. ì§„ì§œ ë§ìƒë§Œ ê°€ëŠ¥ ê·¸ê±° ìˆ˜ìš©í•´ì¤„...</td>
      <td>121</td>
      <td>0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2</td>
      <td>0.693147</td>
      <td>0.000000</td>
      <td>0.693147</td>
      <td>0.693147</td>
      <td>121</td>
      <td>32</td>
    </tr>
    <tr>
      <th>3564041</th>
      <td>í–‰ì‚¬</td>
      <td>ì—¬ì„±</td>
      <td>20ëŒ€</td>
      <td>ì„œìš¸íŠ¹ë³„ì‹œ</td>
      <td>ã…‹ã…‹ã…‹ã…‹ã… ã… ì—‰ì—‰ ëœë‹¤ê³  í•´ì£¼ì„¸ìš” ê·¸ë‹ˆê¹Œ ë§ìƒ ë™ì°½íšŒ ê·¸ì •ë„ë©´ ì—°íšŒì¥ ë¹Œë ¤ì•¼í•¨ ã…‹ã…‹ã…‹...</td>
      <td>130</td>
      <td>3</td>
      <td>2.934882</td>
      <td>0.773283</td>
      <td>3.952616</td>
      <td>2.079442</td>
      <td>1</td>
      <td>0.693147</td>
      <td>0.000000</td>
      <td>0.693147</td>
      <td>0.693147</td>
      <td>130</td>
      <td>26</td>
    </tr>
  </tbody>
</table>
<p>3502912 rows Ã— 18 columns</p>
</div>




```python
df.to_csv('SNS_FULL_Dataset(í…ìŠ¤íŠ¸ ì „ì²˜ë¦¬).csv', index=False)
```


```python
m_df = df.loc[df['sex'] == 'ë‚¨ì„±']
f_df = df.loc[df['sex'] == 'ì—¬ì„±']

a10_df = df.loc[df['age'] == '20ëŒ€ ë¯¸ë§Œ']
a20_df = df.loc[df['age'] == '20ëŒ€']
a30_df = df.loc[df['age'] == '30ëŒ€']
a40_df = df.loc[df['age'] == '40ëŒ€']
a50_df = df.loc[df['age'] == '50ëŒ€']
a60_df = df.loc[df['age'] == '60ëŒ€']
a70_df = df.loc[df['age'] == '70ëŒ€ ì´ìƒ']

total = len(df)
male = len(m_df)
female = len(f_df)
a10 = len(a10_df)
a20 = len(a20_df)
a30 = len(a30_df)
a40 = len(a40_df)
a50 = len(a50_df)
a60 = len(a60_df)
a70 = len(a70_df)


print(total,
      male,
      female,
      a10,
      a20,
      a30,
      a40,
      a50,
      a60,
      a70)
print(total/total,
      male/total,
      female/total,
      a10/total,
      a20/total,
      a30/total,
      a40/total,
      a50/total,
      a60/total,
      a70/total)
```

    3502912 781004 2721908 101295 2587764 694512 64892 41849 11724 876
    1.0 0.2229584985292237 0.7770415014707763 0.028917369320154204 0.738746505764347 0.19826704182120475 0.018525158496702172 0.011946917307657172 0.0033469296402535947 0.00025007764968117954
    


```python

```
